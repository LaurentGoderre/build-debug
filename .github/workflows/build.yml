name: Build
on: push

jobs:
    build:
        strategy:
            matrix:
                os: [ubuntu-24.04, ubuntu-22.04, ubuntu-20.04]
                image: ['docker/scout-sbom-indexer:1.14.0', 'laurentgoderre689/scout-sbom-indexer:1.14.0-fix']
        runs-on: ${{ matrix.os }}
        steps:
          - name: Checkout
            uses: actions/checkout@v4
          - name: Setup
            run: |
              docker buildx create \
                --name "container-builder" \
                --node "container-builder" \
                --platform "linux/amd64" \
                --driver docker-container \
                --bootstrap --use
          - name: test
            env:
              IMAGE: ${{ matrix.image }}
            run: docker buildx b . --sbom="generator=$IMAGE"
